{% extends "layouts/base-with-nav.njk" %}

{% block pageTitle %}
  BCR Module Status - RRDM
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <h1 class="govuk-heading-xl">BCR Module Status</h1>
      
      <!-- Module Overview -->
      <div class="govuk-inset-text">
        <h2 class="govuk-heading-m">Module Overview</h2>
        <p class="govuk-body">
          The BCR (Business Change Request) module is a key component of the RRDM system, allowing users to submit, track, and manage business change requests through a defined workflow. This page provides a technical overview of the module's components and their status.
        </p>
        <div class="govuk-button-group">
          <a href="/bcr" role="button" draggable="false" class="govuk-button" data-module="govuk-button">
            BCR Dashboard
          </a>
          <a href="/bcr/submissions" role="button" draggable="false" class="govuk-button govuk-button--secondary" data-module="govuk-button">
            BCR Submissions
          </a>
        </div>
      </div>
      
      <!-- Models Status -->
      <div class="govuk-inset-text">
        <h2 class="govuk-heading-m">Models Status</h2>
        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">Model</th>
              <th scope="col" class="govuk-table__header">Status</th>
              <th scope="col" class="govuk-table__header">Record Count</th>
            </tr>
          </thead>
          <tbody class="govuk-table__body">
            {% for model in models %}
              <tr class="govuk-table__row">
                <td class="govuk-table__cell">{{ model.name }}</td>
                <td class="govuk-table__cell">
                  {% if model.exists %}
                    <strong class="govuk-tag govuk-tag--green">Available</strong>
                  {% else %}
                    <strong class="govuk-tag govuk-tag--red">Missing</strong>
                  {% endif %}
                </td>
                <td class="govuk-table__cell">{{ model.count }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      
      <!-- Controllers Status -->
      <div class="govuk-inset-text">
        <h2 class="govuk-heading-m">Controllers Status</h2>
        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">Controller</th>
              <th scope="col" class="govuk-table__header">Status</th>
              <th scope="col" class="govuk-table__header">Path</th>
            </tr>
          </thead>
          <tbody class="govuk-table__body">
            {% for controller in controllers %}
              <tr class="govuk-table__row">
                <td class="govuk-table__cell">{{ controller.name }}</td>
                <td class="govuk-table__cell">
                  {% if controller.exists %}
                    <strong class="govuk-tag govuk-tag--green">Available</strong>
                  {% else %}
                    <strong class="govuk-tag govuk-tag--red">Missing</strong>
                  {% endif %}
                </td>
                <td class="govuk-table__cell">{{ controller.path }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      
      <!-- Routes Status -->
      <div class="govuk-inset-text">
        <h2 class="govuk-heading-m">Routes Status</h2>
        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">Route File</th>
              <th scope="col" class="govuk-table__header">Status</th>
              <th scope="col" class="govuk-table__header">Path</th>
            </tr>
          </thead>
          <tbody class="govuk-table__body">
            {% for route in routes %}
              <tr class="govuk-table__row">
                <td class="govuk-table__cell">{{ route.name }}</td>
                <td class="govuk-table__cell">
                  {% if route.exists %}
                    <strong class="govuk-tag govuk-tag--green">Available</strong>
                  {% else %}
                    <strong class="govuk-tag govuk-tag--red">Missing</strong>
                  {% endif %}
                </td>
                <td class="govuk-table__cell">{{ route.path }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      
      <!-- Views Status -->
      <div class="govuk-inset-text">
        <h2 class="govuk-heading-m">Views Status</h2>
        <p class="govuk-body">
          Total views: {{ views.length }}
        </p>
        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">View Template</th>
              <th scope="col" class="govuk-table__header">Status</th>
              <th scope="col" class="govuk-table__header">Path</th>
            </tr>
          </thead>
          <tbody class="govuk-table__body">
            {% for view in views %}
              <tr class="govuk-table__row">
                <td class="govuk-table__cell">{{ view.name }}</td>
                <td class="govuk-table__cell">
                  {% if view.exists %}
                    <strong class="govuk-tag govuk-tag--green">Available</strong>
                  {% else %}
                    <strong class="govuk-tag govuk-tag--red">Missing</strong>
                  {% endif %}
                </td>
                <td class="govuk-table__cell">{{ view.path }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      
      <!-- BPMN Workflow Status -->
      <div class="govuk-inset-text">
        <h2 class="govuk-heading-m">BPMN Workflow Status</h2>
        <p class="govuk-body">
          The BCR module follows a Business Process Model and Notation (BPMN) workflow that defines the lifecycle of a BCR from submission to closure.
        </p>
        <div class="govuk-warning-text">
          <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
          <strong class="govuk-warning-text__text">
            <span class="govuk-visually-hidden">Warning</span>
            For a detailed view of the workflow, visit the <a href="/bcr/workflow" class="govuk-link">BCR Workflow</a> page.
          </strong>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
